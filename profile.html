<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Student Profile</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background-color: #f5f6fa;
      margin: 0;
      padding: 0;
    }

    /*  HEADER PERFECTLY ON TOP */
    .profile-header {
      background: #004aad;
      color: #0b0c0c;
      padding: 14px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .profile-header h1 {
      font-size: 22px;
      margin: 0;
      font-weight: 600;
    }

    .back-btn {
      background: #f5f6fa;
      color: #004aad;
      padding: 8px 14px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
    }

    .profile-card {
      border-radius: 15px;
    }

    .avatar-wrapper {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      overflow: hidden;
      border: 3px solid #004aad;
      margin: 0 auto;
    }

    .avatar-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .profile-name {
      font-size: 1.3rem;
      font-weight: 600;
    }

    .profile-subtitle {
      font-size: 0.9rem;
      color: #6c757d;
    }

    .section-title {
      font-size: 1.1rem;
      font-weight: 600;
      border-left: 4px solid #004aad;
      padding-left: 8px;
      margin-bottom: 12px;
    }
  </style>
</head>

<body>

  <!-- TOP HEADER -->
  <div class="profile-header">
    <h1>Student Profile</h1>
    <a href="teacher.html" class="back-btn">← Back to Teacher</a>
  </div>

  <div class="container py-4">

    <div class="row">

      <!-- LEFT PROFILE CARD -->
      <div class="col-lg-4 mb-4">
        <div class="card profile-card shadow-sm">
          <div class="card-body text-center">
            <div class="avatar-wrapper mb-3">
              <img src="assests/css/assests/js/assests/images/student1.jpg">
            </div>

            <div id="sp_name" class="profile-name">Loading...</div>
            <div id="sp_course" class="profile-subtitle">--</div>

            <div class="mt-2">
              <span class="badge bg-danger">Student ID: <span id="sp_id"></span></span>
            </div>

            <hr>

            <div class="text-start small">
              <p><strong>Program:</strong> <span id="sp_program"></span></p>
              <p><strong>Branch:</strong> <span id="sp_branch"></span></p>
              <p><strong>Semester:</strong> <span id="sp_sem"></span></p>
              <p><strong>Section:</strong> <span id="sp_section"></span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT FORM -->
      <div class="col-lg-8">
        <div class="card shadow-sm profile-card">
          <div class="card-body">

            <form id="profileForm">

              <div class="section-title">Personal Details</div>
              <div class="row g-3 mb-3">
                <div class="col-md-6">
                  <label class="form-label">Student ID</label>
                  <input type="text" id="pf_roll" class="form-control">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Full Name</label>
                  <input type="text" id="pf_name" class="form-control">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Date of Birth</label>
                  <input type="date" class="form-control">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Gender</label>
                  <select class="form-select">
                    <option>Female</option>
                    <option>Male</option>
                    <option>Other</option>
                  </select>
                </div>
              </div>

              <div class="section-title">Academic Details</div>
              <div class="row g-3 mb-3">
                <div class="col-md-6">
                  <label class="form-label">Program</label>
                  <input id="pf_program" class="form-control">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Branch</label>
                  <input id="pf_branch" class="form-control">
                </div>

                <div class="col-md-4">
                  <label class="form-label">Semester</label>
                  <input id="pf_sem" class="form-control">
                </div>

                <div class="col-md-4">
                  <label class="form-label">Section</label>
                  <input id="pf_section" class="form-control">
                </div>

                <div class="col-md-4">
                  <label class="form-label">Enrollment Year</label>
                  <input id="pf_year" class="form-control">
                </div>
              </div>

              <div class="section-title">Contact Details</div>
              <div class="row g-3 mb-3">
                <div class="col-md-6">
                  <label class="form-label">Email</label>
                  <input id="pf_email" class="form-control">
                </div>

                <div class="col-md-6">
                  <label class="form-label">Mobile</label>
                  <input id="pf_phone" class="form-control">
                </div>

                <div class="col-md-12">
                  <label class="form-label">Address</label>
                  <textarea class="form-control" rows="2"></textarea>
                </div>
              </div>

              <div class="d-flex justify-content-end gap-2">
                <button type="reset" class="btn btn-outline-secondary">Reset</button>
                <button type="submit" class="btn btn-danger">Save Changes</button>
              </div>

            </form>

          </div>
        </div>
      </div>

    </div>
  </div>

 <script>
const params = new URLSearchParams(window.location.search);
const rollNo = params.get("roll");

//  NO REDIRECT, NO ALERT LOOP
if (!rollNo) {
  document.getElementById("sp_name").innerText = "No Student Selected";
} else {

  fetch("http://127.0.0.1:5000/students")
    .then(res => res.json())
    .then(data => {

      const student = data.find(s => s.roll_no == rollNo);

      // Agar student nahi mila – page wahi rahega
      if (!student) {
        document.getElementById("sp_name").innerText = "Student Not Found";
        return;
      }

      document.getElementById("sp_name").innerText = student.name;
      document.getElementById("sp_course").innerText = student.class;
      document.getElementById("sp_id").innerText = student.roll_no;

      document.getElementById("sp_program").innerText = student.class;
      document.getElementById("sp_branch").innerText = "CSE";
      document.getElementById("sp_sem").innerText = "3rd";
      document.getElementById("sp_section").innerText = "A";

      document.getElementById("pf_roll").value = student.roll_no;
      document.getElementById("pf_name").value = student.name;
      document.getElementById("pf_program").value = student.class;
      document.getElementById("pf_branch").value = "CSE";
      document.getElementById("pf_sem").value = "3rd";
      document.getElementById("pf_section").value = "A";
      document.getElementById("pf_year").value = "2023";
      document.getElementById("pf_email").value = student.email || "";
      document.getElementById("pf_phone").value = student.phone || "";
    });
}

//  FORM SAVE DEMO
document.getElementById("profileForm").addEventListener("submit", function(e) {
  e.preventDefault();
  alert("Profile Saved (Demo)");
});
</script>

</body>
</html>
